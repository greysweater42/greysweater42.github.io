<!DOCTYPE html>
<html lang="en">
<head>

  <title>greysweater42&#39;s cookbook</title>
  <link rel="shortcut icon" type='image/x-icon' href="https://greysweater42.github.io/favicon.ico"/> 

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link href="https://fonts.googleapis.com/css?family=Ubuntu&display=swap" rel="stylesheet">        
  <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono&display=swap" rel="stylesheet">

  <link href="https://fonts.googleapis.com/css?family=Fascinate&display=swap" rel="stylesheet">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="https://greysweater42.github.io/css/bootstrap-toc.css">

  
  <link rel="stylesheet" href="https://greysweater42.github.io/css/darcula.css">

  
  <link rel="stylesheet" href="https://greysweater42.github.io/css/style.css">

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-NNMCY8RRGL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-NNMCY8RRGL');
  </script>

</head>


<body data-spy="scroll" data-target="#toc">



<nav id="navbar" class="navbar navbar-expand-md fixed-top navbar-hide transition">

  
  <a class="navbar-brand"></a>

  <button class="navbar-toggler float-xs-right" data-toggle="collapse" data-target="#collapsibleNavbar">
    Menu
  </button>

  <div class="collapse navbar-collapse" id="collapsibleNavbar">

    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="https://greysweater42.github.io">Home</a>
      </li>
      
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">Python</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://greysweater42.github.io/airflow/">airflow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/async_thread/">async/threads</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/beautiful_soup/">beautiful soup</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/decorators/">decorators</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/fastai/">fastai</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/flask/">flask</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/ggplot2/">ggplot2</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/keras/">keras</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/learning_tensorflow/">learning tensorflow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/logging/">logging</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pandas/">pandas</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pillow/">pillow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pyenv/">pyenv, virtualenv, freeze</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pytorch/">pytorch</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pytorch_basics/">pytorch basics</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/spark/">spark</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/sqlalchemy/">sqlAlchemy</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/tensorflow/">tensorflow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/testing/">testing</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">R</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://greysweater42.github.io/cinr/">C in R</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/classess4/">classes - S4</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/data.table/">data.table</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/debugging/">debugging</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/decision_trees/">decision trees</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/ggplot2/">ggplot2</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/logging/">logging</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/lubridate/">lubridate</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/nls/">nls</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/packages/">packages</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/rcpp/">Rcpp</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/reshape2/">reshape2</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/rmariadb/">RMariaDB (former RMySQL)</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/rocker/">rocker</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/rstanarm/">rstanarm</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/rtags/">rTags</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/shiny/">shiny</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/spark/">spark</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/sqldf/">sqldf</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/testing/">testing</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/tidyverse/">tidyverse</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">Machine learning</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://greysweater42.github.io/ml/">basic machine learning algorithms</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/decision_trees/">decision trees</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/fastai/">fastai</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/keras/">keras</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/learning_tensorflow/">learning tensorflow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/validation/">model validation</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/nlp/">nlp</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/nls/">nls</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pca/">PCA / SVD</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pillow/">pillow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pytorch/">pytorch</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pytorch_basics/">pytorch basics</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/tensorflow/">tensorflow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/useful_processing/">useful processing</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/xai/">XAI</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/xgboost/">xgboost</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">Data engineering</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://greysweater42.github.io/airflow/">airflow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/async_thread/">async/threads</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/hadoop/">hadoop</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/logging/">logging</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pandas/">pandas</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/spark/">spark</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/testing/">testing</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/useful_processing/">useful processing</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">DevOps</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://greysweater42.github.io/bash/">bash</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/docker/">docker</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/flask/">flask</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/git/">git</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/heroku/">heroku</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/mesos/">mesos</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pyenv/">pyenv, virtualenv, freeze</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/rocker/">rocker</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/testing/">testing</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/vagrant/">vagrant</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">Projects</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://greysweater42.github.io/fiat_ferrari/">fiat 126 v ferrari</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/finance_nn/">neural networks vs stock market</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/reading_mate/">reading mate</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/vim_vs_emacs/">vim vs emacs - text mining to settle the editor war</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/cookbook/">writing a cookbook</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">scratchpad</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pandas/">pandas</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/passing_arguments/">passing arguments to scripts</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/redis/">redis</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/tensorflow_serving/">tensorflow_serving</a>
          
        </div>
      </li>
    
    </ul>

  </div>  

</nav>



<div class="jumbotron text-center" id="header">

  <div id="header-title">
      <a href="https://greysweater42.github.io">greysweater42&#39;s cookbook</a>
  </div>

  <p style="color: white;">data science tutorials and snippets prepared by greysweater42</p> 

</div>


<nav id="toc" data-toggle="toc" class="sticky-top d-none d-xl-block"></nav>

<div class="article">

<div class="article-categories">
  
    <object style="vertical-align:middle" type="image/svg+xml" data="/folder.svg" height="15px" width="15px"></object> 
    <a href="https://greysweater42.github.io/categories/machine-learning" role="button">Machine learning </a>
    &emsp;
  </br>
</div>
<div class="article-title">
  
  model validation

</div>
<div class="article-info">
    May 23, 2019 &emsp;  &emsp; 7 minutes read
</div>




<div id="what-is-model-validation-and-why-would-you-do-it" class="section level2">
<h2>1. What is model validation and why would you do it?</h2>
<p>You learned your model and naturally you are wondering how good it is. There is no universal measure of “goodness”, so usually you have to combine a few different measures and by getting a broader picture, make the final decision: whether your model is worth anything ;).</p>
<p>In machine learning the two most popular problems are <strong>classification</strong> and <strong>regression</strong> (in machine learning regression refers to the problems, where a <em>real</em> value is predicted, not a class as for classification; in statistics it rather refers to linear regression and its derivatives, i.e. a statistical model, which is a group of statistical hypotheses), and both of them use different measures.</p>
</div>
<div id="classification-metrics" class="section level2">
<h2>2. Classification metrics</h2>
<p>Let’s say you created a simple classifier, e.g. using logistic regression. The classifier does not return classes though, but the probability that this particular observation belongs to class 1. As what we need are classes, not probabilities, we have to somehow <em>map</em> these probabilities into classes. The easiest way to achieve this is by using a function like:</p>
<p><span class="math display">\[ f(t) = \begin{cases} 1 &amp; \text{when $p \geqslant t$} \\ 0 &amp; \text{when $p &lt; t$} \\ \end{cases} \]</span></p>
<p>where <span class="math inline">\(t\)</span> is a threshold set by <em>you</em>. Choose wisely ;)</p>
<p>All of the methods presented below assume that you have already chosen the threshold (confusion matrix and its derivatives), or abstract from choosing it (ROC, AUC).</p>
<div id="a-confusion-matrix" class="section level3">
<h3>a) confusion matrix</h3>
<div id="theory" class="section level4">
<h4>- theory</h4>
<p>Confusion matrix is not at all as confusing as the name may suggest. It is arguably the most basic measure of quality of a model and being an experienced data scientist you can immediately tell if the model is good or not. The definition:</p>
<p><span class="math display">\[
\begin{bmatrix}
TP &amp; FN \\
FP &amp; TN 
\end{bmatrix}
\]</span></p>
<p>where <strong>real values</strong> are in <em>rows</em>, <strong>predictions</strong> are in <em>columns</em>, and <em>T</em> means <em>true</em>, <em>F</em> means <em>false</em>, <em>P</em> means <em>positive</em> and <em>N</em> means <em>negative</em>.</p>
</div>
<div id="examples" class="section level4">
<h4>- examples</h4>
<ul>
<li>base R</li>
</ul>
<pre class="r"><code># prepare the dataset
library(caret)</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Warning in system(&quot;timedatectl&quot;, intern = TRUE): running command &#39;timedatectl&#39;
## had status 1</code></pre>
<pre class="r"><code>species &lt;- c(&quot;setosa&quot;, &quot;versicolor&quot;)
d &lt;- iris[iris$Species %in% species,]
d$Species &lt;- factor(d$Species, levels = species)
trainIndex &lt;- caret::createDataPartition(d$Species, p=0.7, list = FALSE, 
                                         times = 1)
train &lt;- d[trainIndex,]
test &lt;- d[-trainIndex,]
y_test &lt;- test$Species == species[2]</code></pre>
<p>and the logistic regression itself:</p>
<pre class="r"><code>m &lt;- glm(Species ~ Sepal.Length, train, family = &quot;binomial&quot;)
y_hat_test &lt;- predict(m, test[,1:4], type = &quot;response&quot;) &gt; 0.5</code></pre>
<p>We’ve prepared our predictions, as well as testing target, as vectors of binary values:</p>
<pre class="r"><code>y_test[1:10]</code></pre>
<pre><code>##  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<pre class="r"><code>y_hat_test[1:10]</code></pre>
<pre><code>##     8    18    21    24    25    26    27    29    32    39 
## FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<p>so now we may use a simple <code>table()</code> function to create a confusion matrix:</p>
<pre class="r"><code>table(y_hat_test, y_test)</code></pre>
<pre><code>##           y_test
## y_hat_test FALSE TRUE
##      FALSE    15    1
##      TRUE      0   14</code></pre>
<ul>
<li>R caret</li>
</ul>
<p>We will use a <a href="https://www.rdocumentation.org/packages/caret/versions/3.45/topics/confusionMatrix">confusionMatrix</a> function. Keep in mind that <code>caret</code> is a huge machine learning library, almost an entire new language inside R, so introducing it into your code just for the sake of confusion matrix may be an overkill.</p>
<p>Still, <code>caret</code> provides a much broader summary of confusion matrix:</p>
<pre class="r"><code>library(caret)
m2 &lt;- train(Species ~ Sepal.Length, train, method = &quot;glm&quot;, family = binomial)
confusionMatrix(predict(m2, test), test$Species)</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##             Reference
## Prediction   setosa versicolor
##   setosa         15          1
##   versicolor      0         14
##                                           
##                Accuracy : 0.9667          
##                  95% CI : (0.8278, 0.9992)
##     No Information Rate : 0.5             
##     P-Value [Acc &gt; NIR] : 2.887e-08       
##                                           
##                   Kappa : 0.9333          
##                                           
##  Mcnemar&#39;s Test P-Value : 1               
##                                           
##             Sensitivity : 1.0000          
##             Specificity : 0.9333          
##          Pos Pred Value : 0.9375          
##          Neg Pred Value : 1.0000          
##              Prevalence : 0.5000          
##          Detection Rate : 0.5000          
##    Detection Prevalence : 0.5333          
##       Balanced Accuracy : 0.9667          
##                                           
##        &#39;Positive&#39; Class : setosa          
## </code></pre>
<pre class="python"><code>from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, confusion_matrix

iris = load_iris()

cond = iris.target != 0
X = iris.data[cond]
y = iris.target[cond]

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.33, random_state=42)

lr = LogisticRegression()

lr.fit(X_train, y_train)</code></pre>
<pre><code>## LogisticRegression()</code></pre>
<pre class="python"><code>accuracy_score(lr.predict(X_test), y_test)</code></pre>
<pre><code>## 0.9393939393939394</code></pre>
<pre class="python"><code>print(confusion_matrix(lr.predict(X_test), y_test))</code></pre>
<pre><code>## [[18  1]
##  [ 1 13]]</code></pre>
</div>
</div>
<div id="b-confusion-matrix-derivatives-precisionrecall-sensisivityspecificity-etc." class="section level3">
<h3>b) confusion matrix derivatives: precision/recall, sensisivity/specificity etc.</h3>
<p>Looking at confusion matrix may be a little confusing though, as you have to extract information from four numbers. Couldn’t we use one or two numbers to make things easier?</p>
<div id="precisionrecall-trade-off" class="section level4">
<h4>- <a href="https://towardsdatascience.com/precision-vs-recall-386cf9f89488">precision/recall trade-off</a></h4>
<p>Just a helpful reminder of confusion matrix:</p>
<p><span class="math display">\[
\begin{bmatrix}
TP &amp; FN \\
FP &amp; TN 
\end{bmatrix}
\]</span></p>
<p>There are two measures based on confusion matrix that are particurarily interesting, called precision and recall:</p>
<p><span class="math display">\[ \textrm{precision} = \frac{\textrm{TP}}{\textrm{TP} + \textrm{FP}} \]</span></p>
<p><span class="math display">\[ \textrm{recall} = \textrm{sensitivity} = \textrm{TPR} = \frac{\textrm{TP}}{\textrm{TP} + \textrm{FN}} \]</span></p>
<p>where TPR means True Positive Rate. Why is this a trade-off? Because you want to maximize both of these measures, but while one goes up, the other goes down.</p>
<p>The values of confusion matrix, on which precision and recall are based, result from the value of the threshold: you can choose a threshold which maximizes any of these measures, depending on your study. You may want the model to be:</p>
<ul>
<li><p><em>conservative</em>, i.e. predict “1” only if it is sure it is “1”: then you choose high threshold and get high precision and low recall (few observations are marked as “1”)</p></li>
<li><p><em>liberal</em>, i.e. predict “1” when the model vaguely believes it might be “1”: then you choose low threshold, get low precision and high recall (many observations are marked as “1”).</p></li>
</ul>
<p>In other words:</p>
<ul>
<li><p>precision: among those predicted as P, what percentage was truelly P?</p></li>
<li><p>recall: among true P, how many was predicted as P?</p></li>
</ul>
</div>
<div id="sensitivityspecificity-pol-sensitivity---czułość-specificity---swoistość" class="section level4">
<h4>- sensitivity/specificity <em>(pol: sensitivity - czułość, specificity - swoistość)</em></h4>
<p>Let’s begin with the definitions:</p>
<p><span class="math display">\[ \textrm{recall} = \textrm{sensitivity} = \textrm{TPR} = \frac{\textrm{TP}}{\textrm{TP} + \textrm{FN}} \]</span></p>
<p><span class="math display">\[ \textrm{specificity} = \textrm{TNR} = \frac{\textrm{TN}}{\textrm{TN} + \textrm{FP}} \]</span></p>
<p>where TPR is True Positive Rate and TNR is True Negative Rate. These two are often used in medicine for testing if a person has a specific condition (is sick/ill) or not. Say we have a test for coronavirus:</p>
<ul>
<li><p>sensitivity (TPR) 95%, meaning that among all the people who have got Covid, 95% of them are labeled “positive” by this test;</p></li>
<li><p>specificity 90%, meaning that among all the people who have <em>not</em> got Covid, 90% are labeled “negative”.</p></li>
</ul>
<p>Similarily to precision and recall, while creating a model you have to choose between high sensitivity and high specificity.</p>
</div>
</div>
<div id="c-roc-auc" class="section level3">
<h3>c) ROC, AUC</h3>
<p>TODO</p>
<ul>
<li><p><a href="https://towardsdatascience.com/beyond-accuracy-precision-and-recall-3da06bea9f6c">another good article</a></p></li>
<li><p><a href="https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5">A wonderful article about AUC and ROC curves</a>. There is no nedd to duplicate it.</p></li>
</ul>
<p>Different values of TPR and FPR for various <span class="math inline">\(t\)</span> create a ROC curve. Area Under this Curve is called AUC.</p>
<p><em>R - using ROCR package</em></p>
<pre class="r"><code>library(ROCR)
plot_roc_get_auc &lt;- function(pred, test_labels) {
  roc_pred &lt;- ROCR::prediction(pred, test_labels)
  roc_perf &lt;- ROCR::performance(roc_pred, measure = &quot;tpr&quot;, x.measure = &quot;fpr&quot;)
  ROCR::plot(roc_perf, col = 1:10)
  abline(a = 0, b = 1)
  auc_perf &lt;- ROCR::performance(roc_pred, measure = &quot;auc&quot;, x.measure = &quot;fpr&quot;)
  return(auc_perf@y.values[[1]])
}

species &lt;- c(&quot;setosa&quot;, &quot;versicolor&quot;)
iris_bin &lt;- iris[iris$Species %in% species,]
iris_bin$Species &lt;- factor(iris_bin$Species, levels = species)
trainIndex &lt;- caret::createDataPartition(iris_bin$Species, p=0.7, list = FALSE, 
                                         times = 1)
train &lt;- iris_bin[trainIndex,]
test &lt;- iris_bin[-trainIndex,]


m &lt;- glm(Species ~ Sepal.Length, train, family = binomial)
plot_roc_get_auc(
  pred = predict(m, test[,1:4], type = &quot;response&quot;),
  test_labels = as.integer(test[[&quot;Species&quot;]]) - 1)</code></pre>
<p><img src="https://greysweater42.github.io/validation_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre><code>## [1] 0.9044444</code></pre>
<pre class="r"><code>rf &lt;- randomForest::randomForest(Species ~ ., data = train)
plot_roc_get_auc(
  pred = predict(rf, test[, 1:4], type = &quot;prob&quot;)[,&#39;versicolor&#39;],
  test_labels = as.integer(test[[&quot;Species&quot;]]) - 1)</code></pre>
<p><img src="https://greysweater42.github.io/validation_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<pre><code>## [1] 1</code></pre>
</div>
<div id="cross-validation" class="section level3">
<h3>cross-validation</h3>
<p>TODO</p>
<p><a href="https://towardsdatascience.com/supervised-machine-learning-model-validation-a-step-by-step-approach-771109ae0253" class="uri">https://towardsdatascience.com/supervised-machine-learning-model-validation-a-step-by-step-approach-771109ae0253</a></p>
<p>ROC - TPR vs FPR, where</p>
<p>TPR - True Positive Rate
TP - True Positive
FP - False Positive</p>
<p>parameter search</p>
<p><a href="https://scikit-learn.org/stable/modules/grid_search.html#tuning-the-hyper-parameters-of-an-estimator" class="uri">https://scikit-learn.org/stable/modules/grid_search.html#tuning-the-hyper-parameters-of-an-estimator</a></p>
<p>TODO: <a href="https://rviews.rstudio.com/2019/03/01/some-r-packages-for-roc-curves/" class="uri">https://rviews.rstudio.com/2019/03/01/some-r-packages-for-roc-curves/</a></p>
<p>TODO: <a href="https://www.saedsayad.com/model_evaluation_c.htm" class="uri">https://www.saedsayad.com/model_evaluation_c.htm</a></p>
<p>TODO: <a href="https://eli5.readthedocs.io/en/latest/" class="uri">https://eli5.readthedocs.io/en/latest/</a></p>
<p>TODO: <a href="https://towardsdatascience.com/explaining-feature-importance-by-example-of-a-random-forest-d9166011959e" class="uri">https://towardsdatascience.com/explaining-feature-importance-by-example-of-a-random-forest-d9166011959e</a></p>
<p>TODO: <a href="https://github.com/slundberg/shap" class="uri">https://github.com/slundberg/shap</a></p>
</div>
</div>

</div>

<div class="jumbotron text-center" id="footer">

  made using &emsp;
  <br class="d-xl-none">
  <a href="https://gohugo.io/">Hugo</a> |
  <a href="https://getbootstrap.com/">Bootstrap</a> |
  <a href="https://highlightjs.org/">highlightjs</a> |
  <a href="https://bookdown.org/yihui/blogdown/">blogdown</a> |
  <a href="https://fonts.google.com/">Google fonts</a> &emsp;
  <br class="d-xl-none">
  <a href="https://github.com/greysweater42/cookbook">github</a> |
  <a href="https://pages.github.com/">github pages</a> |
  <br>
  about me: <a href="https://www.linkedin.com/in/tomasz-dyrka-490766127/">LinkedIn</a>

</div>

</body>



<script src="https://greysweater42.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>


<script src="https://greysweater42.github.io/js/bootstrap-toc.js"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>


<script>
$(window).scroll(function() {
  
  if ($(window).scrollTop() > 100 ) {
    $('.navbar').removeClass('navbar-hide');
    $('.navbar').addClass('navbar-show');
  } else {
    $('.navbar').removeClass('navbar-show');
    $('.navbar').addClass('navbar-hide');
  };   	
});
</script>

</html>

