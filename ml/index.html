<!DOCTYPE html>
<html lang="en">
<head>

  <title>greysweater42&#39;s cookbook</title>
  <link rel="shortcut icon" type='image/x-icon' href="https://greysweater42.github.io/favicon.ico"/> 

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link href="https://fonts.googleapis.com/css?family=Ubuntu&display=swap" rel="stylesheet">        
  <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono&display=swap" rel="stylesheet">

  <link href="https://fonts.googleapis.com/css?family=Fascinate&display=swap" rel="stylesheet">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="https://greysweater42.github.io/css/bootstrap-toc.css">

  
  <link rel="stylesheet" href="https://greysweater42.github.io/css/darcula.css">

  
  <link rel="stylesheet" href="https://greysweater42.github.io/css/style.css">

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-NNMCY8RRGL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-NNMCY8RRGL');
  </script>

</head>


<body data-spy="scroll" data-target="#toc">



<nav id="navbar" class="navbar navbar-expand-md fixed-top navbar-hide transition">

  
  <a class="navbar-brand"></a>

  <button class="navbar-toggler float-xs-right" data-toggle="collapse" data-target="#collapsibleNavbar">
    Menu
  </button>

  <div class="collapse navbar-collapse" id="collapsibleNavbar">

    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="https://greysweater42.github.io">Home</a>
      </li>
      
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">Python</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://greysweater42.github.io/airflow/">airflow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/async_thread/">async/threads</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/beautiful_soup/">beautiful soup</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/decorators/">decorators</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/fastai/">fastai</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/flask/">flask</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/ggplot2/">ggplot2</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/keras/">keras</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/learning_tensorflow/">learning tensorflow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/logging/">logging</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pandas/">pandas</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pillow/">pillow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pyenv/">pyenv, virtualenv, freeze</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pytorch/">pytorch</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pytorch_basics/">pytorch basics</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/spark/">spark</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/sqlalchemy/">sqlAlchemy</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/tensorflow/">tensorflow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/testing/">testing</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">R</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://greysweater42.github.io/cinr/">C in R</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/classess4/">classes - S4</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/data.table/">data.table</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/debugging/">debugging</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/decision_trees/">decision trees</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/ggplot2/">ggplot2</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/logging/">logging</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/lubridate/">lubridate</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/nls/">nls</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/packages/">packages</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/rcpp/">Rcpp</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/reshape2/">reshape2</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/rmariadb/">RMariaDB (former RMySQL)</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/rocker/">rocker</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/rstanarm/">rstanarm</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/rtags/">rTags</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/shiny/">shiny</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/spark/">spark</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/sqldf/">sqldf</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/testing/">testing</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/tidyverse/">tidyverse</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">Machine learning</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://greysweater42.github.io/ml/">basic machine learning algorithms</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/decision_trees/">decision trees</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/fastai/">fastai</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/keras/">keras</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/learning_tensorflow/">learning tensorflow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/validation/">model validation</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/nlp/">nlp</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/nls/">nls</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pca/">PCA / SVD</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pillow/">pillow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pytorch/">pytorch</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pytorch_basics/">pytorch basics</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/tensorflow/">tensorflow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/useful_processing/">useful processing</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/xai/">XAI</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/xgboost/">xgboost</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">Data engineering</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://greysweater42.github.io/airflow/">airflow</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/async_thread/">async/threads</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/hadoop/">hadoop</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/logging/">logging</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pandas/">pandas</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/spark/">spark</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/testing/">testing</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/useful_processing/">useful processing</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">DevOps</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://greysweater42.github.io/bash/">bash</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/docker/">docker</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/flask/">flask</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/git/">git</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/heroku/">heroku</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/mesos/">mesos</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pyenv/">pyenv, virtualenv, freeze</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/rocker/">rocker</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/testing/">testing</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/vagrant/">vagrant</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">Projects</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://greysweater42.github.io/fiat_ferrari/">fiat 126 v ferrari</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/finance_nn/">neural networks vs stock market</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/reading_mate/">reading mate</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/vim_vs_emacs/">vim vs emacs - text mining to settle the editor war</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/cookbook/">writing a cookbook</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">scratchpad</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://greysweater42.github.io/pandas/">pandas</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/passing_arguments/">passing arguments to scripts</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/redis/">redis</a>
          
            <a class="dropdown-item" href="https://greysweater42.github.io/tensorflow_serving/">tensorflow_serving</a>
          
        </div>
      </li>
    
    </ul>

  </div>  

</nav>



<div class="jumbotron text-center" id="header">

  <div id="header-title">
      <a href="https://greysweater42.github.io">greysweater42&#39;s cookbook</a>
  </div>

  <p style="color: white;">data science tutorials and snippets prepared by greysweater42</p> 

</div>


<nav id="toc" data-toggle="toc" class="sticky-top d-none d-xl-block"></nav>

<div class="article">

<div class="article-categories">
  
    <object style="vertical-align:middle" type="image/svg+xml" data="/folder.svg" height="15px" width="15px"></object> 
    <a href="https://greysweater42.github.io/categories/machine-learning" role="button">Machine learning </a>
    &emsp;
  </br>
</div>
<div class="article-title">
  
  basic machine learning algorithms

</div>
<div class="article-info">
    Apr 22, 2019 &emsp;  &emsp; 6 minutes read
</div>

<h2 id="1-what-is-machine-learning-and-why-would-you-use-it">1. What is machine learning and why would you use it?</h2>
<ul>
<li>
<p>it&rsquo;s a rather complicated, yet beautiful tool for boldly going where no man has gone before.</p>
</li>
<li>
<p>in other words, it enables you to extract valuable information from data.</p>
</li>
</ul>
<h2 id="2-examples-of-the-most-popular-machine-learning-algorithms-in-python-and-r">2. Examples of the most popular machine learning algorithms in Python and R</h2>
<p>We&rsquo;ll be working on <code>iris</code> dataset, which is easily available in Python (<code>from sklearn import datasets; datasets.load_iris()</code>) and R (<code>data(iris)</code>).</p>
<p>We will use a few of the most popular machine learning tools:</p>
<ul>
<li>
<p>R base,</p>
</li>
<li>
<p>R caret,</p>
<ul>
<li>
<p><a href="https://cran.r-project.org/web/packages/caret/vignettes/caret.html">a short introduction to caret</a></p>
</li>
<li>
<p><a href="http://topepo.github.io/caret/index.html">The <em>caret</em> package</a></p>
</li>
</ul>
</li>
<li>
<p>Python scikit-learn,</p>
</li>
<li>
<p>Python API to <a href="http://tomis9.com/tensorflow">tensorflow</a>. <code>tensorflow</code> was used in very few cases, because it is designed mainly for neural networks, and we would have to implement the algorithms from scratch.</p>
</li>
</ul>
<p>Let&rsquo;s prepare data for our algorithms. You can read more about data preparation in <a href="http://tomis9.com/useful_processing">this blog post</a>.</p>
<h3 id="data-preparation">data preparation</h3>
<p><em>Python</em></p>
<pre><code class="language-{python," data-lang="{python,">from sklearn import datasets
from sklearn.metrics import accuracy_score
from sklearn.model_selection import train_test_split

iris = datasets.load_iris()
X, y = iris.data, iris.target

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.33, random_state=42)

boston = datasets.load_boston()
# I will divide boston dataset to train and test later on
</code></pre><p><em>tensorflow</em></p>
<p>You can use functions from <a href="https://medium.com/tensorflow/introducing-tensorflow-datasets-c7f01f7e19f3">tensorflow_datasets</a> module, but&hellip; does anybody use them?</p>
<p><em>base R</em></p>
<pre><code class="language-{r," data-lang="{r,"># unfortunately base R does not provide a function for train/test split
train_test_split &lt;- function(test_size = 0.33, dataset) {
    smp_size &lt;- floor(test_size * nrow(dataset))
    test_ind &lt;- sample(seq_len(nrow(dataset)), size = smp_size)

    test &lt;- dataset[test_ind, ]
    train &lt;- dataset[-test_ind, ]
    return(list(train = train, test = test))
}

library(gsubfn)
list[train, test] &lt;- train_test_split(0.5, iris)
</code></pre><p><em>caret R</em></p>
<pre><code class="language-{r}" data-lang="{r}"># docs: ..., the random sampling is done within the
# levels of ‘y’ when ‘y’ is a factor in an attempt to balance the class
# distributions within the splits.
# I provide package's name before function's name for clarity
</code></pre><pre><code class="language-{r," data-lang="{r,">trainIndex &lt;- caret::createDataPartition(iris$Species, p=0.7, list = FALSE, 
                                         times = 1)
train &lt;- iris[trainIndex,]
test &lt;- iris[-trainIndex,]
</code></pre><h3 id="svm">SVM</h3>
<p>The best description of SVM I found is in <em>Data mining and analysis - Zaki, Meira</em>. In general, I highly recommend this book.</p>
<p><em>Python</em></p>
<pre><code class="language-{python," data-lang="{python,">from sklearn.svm import SVC  # support vector classification

svc = SVC()
svc.fit(X_train, y_train)

print(accuracy_score(svc.predict(X_test), y_test))
</code></pre><p>TODO: <a href="https://scikit-learn.org/0.18/auto_examples/svm/plot_iris.html">plotting svm in scikit</a></p>
<p><em>&ldquo;base&rdquo; R</em></p>
<pre><code class="language-{r}" data-lang="{r}">svc &lt;- e1071::svm(Species ~ ., train)

pred &lt;- as.character(predict(svc, test[, 1:4]))
mean(pred == test[&quot;Species&quot;])
</code></pre><p><em>caret R</em></p>
<pre><code class="language-{r," data-lang="{r,">svm_linear &lt;- caret::train(Species ~ ., data = train, method = &quot;svmLinear&quot;)
mean(predict(svm_linear, test) == test$Species)
</code></pre><h3 id="decision-trees">decision trees</h3>
<p><em>Python</em></p>
<pre><code class="language-{python," data-lang="{python,">from sklearn.tree import DecisionTreeClassifier

dtc = DecisionTreeClassifier()
dtc.fit(X_train, y_train)

print(accuracy_score(y_test, dtc.predict(X_test)))
</code></pre><p>TODO: <a href="https://medium.com/@rnbrown/creating-and-visualizing-decision-trees-with-python-f8e8fa394176">an article on drawing decision trees in Python</a></p>
<p><em>&ldquo;base&rdquo; R</em></p>
<pre><code class="language-{r}" data-lang="{r}">dtc &lt;- rpart::rpart(Species ~ ., train)
print(dtc)
rpart.plot::rpart.plot(dtc)
pred &lt;- predict(dtc, test[,1:4], type = &quot;class&quot;)
mean(pred == test[[&quot;Species&quot;]])
</code></pre><p><em>caret R</em></p>
<pre><code class="language-{r}" data-lang="{r}">c_dtc &lt;- caret::train(Species ~ ., train, method = &quot;rpart&quot;)
print(c_dtc)
rpart.plot::rpart.plot(c_dtc$finalModel)
</code></pre><p>I described working with decision trees in R in more detail in <a href="http://tomis9.com/decision_trees/">another blog post</a>.</p>
<h3 id="random-forests">random forests</h3>
<p><em>Python</em></p>
<pre><code class="language-{python," data-lang="{python,">from sklearn.ensemble import RandomForestClassifier

rfc = RandomForestClassifier()
rfc.fit(X_train, y_train)

print(accuracy_score(rfc.predict(X_test), y_test))
</code></pre><p><em>&ldquo;base&rdquo; R</em></p>
<pre><code class="language-{r}" data-lang="{r}">rf &lt;- randomForest::randomForest(Species ~ ., data = train)
mean(predict(rf, test[, 1:4]) == test[[&quot;Species&quot;]])
</code></pre><p><em>caret R</em></p>
<pre><code class="language-{r}" data-lang="{r}">c_rf &lt;- caret::train(Species ~ ., train, method = &quot;rf&quot;)
print(c_rf)
print(c_dtc$finalModel)
</code></pre><h3 id="knn">knn</h3>
<p><em>Python</em></p>
<pre><code class="language-{python," data-lang="{python,">from sklearn.neighbors import KNeighborsClassifier

knn = KNeighborsClassifier()
knn.fit(X, y)
print(accuracy_score(y, knn.predict(X)))
</code></pre><p><em>R</em></p>
<pre><code class="language-{r}" data-lang="{r}">kn &lt;- class::knn(train[,1:4], test[,1:4], cl = train[,5], k = 3) 
mean(kn == test[,5])
</code></pre><p>TODO: caret r knn</p>
<h3 id="kmeans">kmeans</h3>
<p>K-means can be nicely plotted in two dimensions with help of <a href="http://tomis9.com/dimensionality/#pca">PCA</a>.</p>
<p><em>R</em></p>
<pre><code class="language-{r}" data-lang="{r}">pca &lt;- prcomp(iris[,1:4], center = TRUE, scale. = TRUE)
# devtools::install_github(&quot;vqv/ggbiplot&quot;)
ggbiplot::ggbiplot(pca, obs.scale = 1, var.scale = 1, groups = iris$Species, 
                   ellipse = TRUE, circle = TRUE)

iris_pca &lt;- scale(iris[,1:4]) %*% pca$rotation 
iris_pca &lt;- as.data.frame(iris_pca)
iris_pca &lt;- cbind(iris_pca, Species = iris$Species)

ggplot2::ggplot(iris_pca, aes(x = PC1, y = PC2, color = Species)) +
  geom_point()

plot_kmeans &lt;- function(km, iris_pca) {
  # we choose only first two components, so they could be plotted
  plot(iris_pca[,1:2], col = km$cluster, pch = as.integer(iris_pca$Species))
  points(km$centers, col = 1:2, pch = 8, cex = 2)
}
par(mfrow=c(1, 3))
# we use 3 centers, because we already know that there are 3 species
sapply(list(kmeans(iris_pca[,1], centers = 3),
            kmeans(iris_pca[,1:2], centers = 3),
            kmeans(iris_pca[,1:4], centers = 3)),
       plot_kmeans, iris_pca = iris_pca)
</code></pre><p>interesting article - <a href="https://cran.r-project.org/web/packages/broom/vignettes/kmeans.html">kmeans with dplyr and broom</a></p>
<p>TODO: caret r - kmeans</p>
<p>TODO: python - kmeans</p>
<h3 id="linear-regression">linear regression</h3>
<p><em>Python</em></p>
<pre><code class="language-{python," data-lang="{python,">from sklearn.linear_model import LinearRegression
from sklearn import datasets

X, y = boston.data, boston.target

lr = LinearRegression()
lr.fit(X, y)
print(lr.intercept_)
print(lr.coef_)
# TODO calculate this with iris dataset
</code></pre><p><em>tensorflow</em></p>
<ul>
<li>data preparation</li>
</ul>
<pre><code class="language-{python," data-lang="{python,">import tensorflow as tf
from sklearn.datasets import load_iris
import numpy as np

def get_data(tensorflow=True):
    iris = load_iris()
    data = iris.data
    y = data[:, 0].reshape(150, 1)
    x0 = np.ones(150).reshape(150, 1)
    X = np.concatenate((x0, data[:, 1:]), axis=1)
    if tensorflow:
        y = tf.constant(y, name='y')
        X = tf.constant(X, name='X')  # constant is a tensor
    return X, y
</code></pre><ul>
<li>using normal equations</li>
</ul>
<pre><code class="language-{python," data-lang="{python,">def construct_beta_graph(X, y):
    cov = tf.matmul(tf.transpose(X), X, name='cov')
    inv_cov = tf.linalg.inv(cov, name='inv_cov')
    xy = tf.matmul(tf.transpose(X), y, name='xy')
    beta = tf.matmul(inv_cov, xy, name='beta')
    return beta


X, y = get_data()
beta = construct_beta_graph(X, y)
mse = tf.reduce_mean(tf.square(y - tf.matmul(X, beta)))

init = tf.global_variables_initializer()
with tf.Session() as sess:
    init.run()
    print(beta.eval())
    print(mse.eval())
</code></pre><ul>
<li>using gradient descent and mini-batches</li>
</ul>
<pre><code class="language-{python," data-lang="{python,">learning_rate = 0.01
n_iter = 1000

X_train, y_train = get_data(tensorflow=False)

X = tf.placeholder(&quot;float64&quot;, shape=(None, 4))  # placeholder -
y = tf.placeholder(&quot;float64&quot;, shape=(None, 1))

start_values = tf.random_uniform([4, 1], -1, 1, dtype=&quot;float64&quot;)
beta = tf.Variable(start_values, name='beta')
mse = tf.reduce_mean(tf.square(y - tf.matmul(X, beta)))

optimizer = tf.train.GradientDescentOptimizer(learning_rate=learning_rate)
_training = optimizer.minimize(mse)

batch_indexes = np.arange(150).reshape(5,30)

init = tf.global_variables_initializer()
with tf.Session() as sess:
    init.run()
    for i in range(n_iter):
        for batch_index in batch_indexes:
            _training.run(feed_dict={X: X_train[batch_index],
                                     y: y_train[batch_index]})
        if not i % 100:
            print(mse.eval(feed_dict={X: X_train, y: y_train}))
    print(mse.eval(feed_dict={X: X_train, y: y_train}), &quot;- final score&quot;)
    print(beta.eval())
</code></pre><p><em>base R</em></p>
<pre><code class="language-{r}" data-lang="{r}">model &lt;- lm(Sepal.Length ~ ., train)
summary(model)
</code></pre><p><code>lm()</code> function automatically converts factor variables to one-hot encoded features.</p>
<p><em>R caret</em></p>
<pre><code class="language-{r}" data-lang="{r}">library(caret)

m &lt;- train(Sepal.Length ~ ., data = train, method = &quot;lm&quot;)
summary(m)  # exactly the same as lm()
</code></pre><h3 id="logistic-regression">logistic regression</h3>
<p>In these examples I will present classification of a dummy variable.</p>
<p><em>Python</em></p>
<pre><code class="language-{python," data-lang="{python,">from sklearn.linear_model import LogisticRegression

cond = iris.target != 2
X = iris.data[cond]
y = iris.target[cond]

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.33, random_state=42)

lr = LogisticRegression()

lr.fit(X_train, y_train)
accuracy_score(lr.predict(X_test), y_test)
</code></pre><p><em>base R</em></p>
<pre><code class="language-{r}" data-lang="{r}">species &lt;- c(&quot;setosa&quot;, &quot;versicolor&quot;)
d &lt;- iris[iris$Species %in% species,]
d$Species &lt;- factor(d$Species, levels = species)
library(gsubfn)
list[train, test] &lt;- train_test_split(0.5, d)

m &lt;- glm(Species ~ Sepal.Length, train, family = binomial)
# predictions - if prediction is bigger than 0.5, we assume it's a one, 
# or success
y_hat_test &lt;- predict(m, test[,1:4], type = &quot;response&quot;) &gt; 0.5

# glm's doc:
# For ‘binomial’ and ‘quasibinomial’ families the response can also
# be specified as a ‘factor’ (when the first level denotes failure
# and all others success) or as a two-column matrix with the columns
# giving the numbers of successes and failures.
# in our case - species[1] (&quot;setosa&quot;) is a failure (0) and species[2] 
# (&quot;versicolor&quot;) is 1 (success)
# successes:
y_test &lt;- test$Species == species[2]

mean(y_test == y_hat_test)
</code></pre><p><em>R caret</em></p>
<pre><code class="language-{r}" data-lang="{r}">library(caret)
m2 &lt;- train(Species ~ Sepal.Length, data = train, method = &quot;glm&quot;, family = binomial)
mean(predict(m2, test) == test$Species)
</code></pre><h3 id="xgboost">xgboost</h3>
<p><em>Python</em></p>
<pre><code class="language-{python," data-lang="{python,">from xgboost import XGBClassifier

cond = iris.target != 2
X = iris.data[cond]
y = iris.target[cond]

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.33, random_state=42)

xgb = XGBClassifier()
xgb.fit(X_train, y_train)
accuracy_score(xgb.predict(X_test), y_test)
</code></pre><p><em>&ldquo;base&rdquo; R</em></p>
<pre><code class="language-{r}" data-lang="{r}">species &lt;- c(&quot;setosa&quot;, &quot;versicolor&quot;)
d &lt;- iris[iris$Species %in% species,]
d$Species &lt;- factor(d$Species, levels = species)
library(gsubfn)
list[train, test] &lt;- train_test_split(0.5, d)

library(xgboost)
m &lt;- xgboost(
  data = as.matrix(train[,1:4]), 
  label = as.integer(train$Species) - 1,
  objective = &quot;binary:logistic&quot;,
  nrounds = 2)

mean(predict(m, as.matrix(test[,1:4])) &gt; 0.5) == (as.integer(test$Species) - 1)
</code></pre><p>TODO: R: xgb.save(), xgb.importance()</p>
<p><em>caret R</em></p>
<p>TODO: <a href="https://www.kaggle.com/pelkoja/visual-xgboost-tuning-with-caret">tuning xgboost with caret</a></p>

</div>

<div class="jumbotron text-center" id="footer">

  made using &emsp;
  <br class="d-xl-none">
  <a href="https://gohugo.io/">Hugo</a> |
  <a href="https://getbootstrap.com/">Bootstrap</a> |
  <a href="https://highlightjs.org/">highlightjs</a> |
  <a href="https://bookdown.org/yihui/blogdown/">blogdown</a> |
  <a href="https://fonts.google.com/">Google fonts</a> &emsp;
  <br class="d-xl-none">
  <a href="https://github.com/greysweater42/cookbook">github</a> |
  <a href="https://pages.github.com/">github pages</a> |
  <br>
  about me: <a href="https://www.linkedin.com/in/tomasz-dyrka-490766127/">LinkedIn</a>

</div>

</body>



<script src="https://greysweater42.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>


<script src="https://greysweater42.github.io/js/bootstrap-toc.js"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>


<script>
$(window).scroll(function() {
  
  if ($(window).scrollTop() > 100 ) {
    $('.navbar').removeClass('navbar-hide');
    $('.navbar').addClass('navbar-show');
  } else {
    $('.navbar').removeClass('navbar-show');
    $('.navbar').addClass('navbar-hide');
  };   	
});
</script>

</html>

